Some weights of EsmModel were not initialized from the model checkpoint at local_esm_model and are newly initialized: ['pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/Users/huyue/miniforge3/lib/python3.12/site-packages/ot/unbalanced/_sinkhorn.py:738: RuntimeWarning: divide by zero encountered in divide
  u = (a / Kv) ** fi_1
/Users/huyue/miniforge3/lib/python3.12/site-packages/ot/unbalanced/_sinkhorn.py:751: UserWarning: Numerical errors at iteration 0
  warnings.warn("Numerical errors at iteration %s" % i)
/Users/huyue/miniforge3/lib/python3.12/site-packages/ot/gromov/_unbalanced.py:410: RuntimeWarning: divide by zero encountered in scalar divide
  pi_samp = nx.sqrt(mass / nx.sum(pi_samp)) * pi_samp  # shape nx x ny
/Users/huyue/miniforge3/lib/python3.12/site-packages/ot/gromov/_unbalanced.py:410: RuntimeWarning: invalid value encountered in multiply
  pi_samp = nx.sqrt(mass / nx.sum(pi_samp)) * pi_samp  # shape nx x ny
/Users/huyue/miniforge3/lib/python3.12/site-packages/ot/gromov/_unbalanced.py:383: RuntimeWarning: divide by zero encountered in scalar divide
  pi_feat = nx.sqrt(mass / nx.sum(pi_feat)) * pi_feat
/Users/huyue/miniforge3/lib/python3.12/site-packages/ot/gromov/_unbalanced.py:383: RuntimeWarning: invalid value encountered in multiply
  pi_feat = nx.sqrt(mass / nx.sum(pi_feat)) * pi_feat
/Users/huyue/miniforge3/lib/python3.12/site-packages/ot/unbalanced/_sinkhorn.py:738: RuntimeWarning: overflow encountered in divide
  u = (a / Kv) ** fi_1
[KeOps] Warning : CUDA libraries not found or could not be loaded; Switching to CPU only.
✅ Found Apple Silicon GPU. Using MPS for acceleration.

--- Configuration ---
  Sequence A: d1qq5a_.pdb (Chain: auto)
  Sequence B: d3chy__.pdb (Chain: auto)
  Model Path: local_esm_model
  Hyperparameters: alpha=0.9, reg_m=0.1, initial_epsilon=0.001
---------------------
STEP 1: Loading sequences...
ℹ️ No chain specified for d1qq5a_.pdb, auto-selecting first available chain: 'A'
ℹ️ No chain specified for d3chy__.pdb, auto-selecting first available chain: ' '
  - Loaded Sequence A: 245 residues.
  - Loaded Sequence B: 128 residues.

STEP 2: Loading ESM-2 model from 'local_esm_model'...

STEP 3: Generating residue embeddings...

STEP 4: Calculating matrices for FUGW solver...
  - [Matrix Stats] Feature Cost (M): Min=0.168452, Max=1.124098, Mean=0.653379, Non-Zero=31360/31360 (100.00%)
  - [Matrix Stats] Intra-Distance A (Cx): Min=0.000000, Max=1.000000, Mean=0.168033, Non-Zero=59780/60025 (99.59%)
  - [Matrix Stats] Intra-Distance B (Cy): Min=0.000000, Max=1.000000, Mean=0.169291, Non-Zero=16256/16384 (99.22%)

STEP 5: Running Fused Unbalanced Gromov-Wasserstein solver...
  - Attempt 1/6 with epsilon = 1.0e-03...
  - ⚠️ Solver failed on attempt 1: There is NaN in coupling.                           Adjust the relaxation or regularization parameters.
  - Retrying with a larger epsilon...
  - Attempt 2/6 with epsilon = 5.0e-03...
  - ⚠️ Solver failed on attempt 2: There is NaN in coupling.                           Adjust the relaxation or regularization parameters.
  - Retrying with a larger epsilon...
  - Attempt 3/6 with epsilon = 2.5e-02...
  - ⚠️ Solver failed on attempt 3: There is NaN in coupling.                           Adjust the relaxation or regularization parameters.
  - Retrying with a larger epsilon...
  - Attempt 4/6 with epsilon = 1.2e-01...
  - ⚠️ Solver failed on attempt 4: There is NaN in coupling.                           Adjust the relaxation or regularization parameters.
  - Retrying with a larger epsilon...
  - Attempt 5/6 with epsilon = 6.2e-01...
  - Solver succeeded in 4.59 seconds.
  - [Matrix Stats] Final Transport Plan (T): Min=0.000014, Max=0.000040, Mean=0.000024, Non-Zero=31360/31360 (100.00%)

STEP 6: Extracting optimal 1-to-1 assignment...

--- Raw Aligned Pairs (Before Filtering) ---
SeqA PDB Num   AA   <->   SeqB PDB Num   AA  
---------------------------------------------
3              K    <->   7              K   
5              V    <->   8              F   
8              D    <->   13             D   
10             Y    <->   14             F   
11             G    <->   105            G   
12             T    <->   16             T   
18             S    <->   15             S   
19             V    <->   10             V   
34             I    <->   123            I   
39             R    <->   18             R   
41             K    <->   119            K   
43             L    <->   95             I   
44             E    <->   89             E   
52             M    <->   17             M   
54             R    <->   19             R   
57             D    <->   64             D   
58             F    <->   111            F   
61             V    <->   107            V   
63             R    <->   22             R   
64             E    <->   35             E   
65             A    <->   36             A   
66             L    <->   20             I   
67             A    <->   117            E   
69             T    <->   115            T   
70             L    <->   25             L   
71             G    <->   26             K   
72             T    <->   71             T   
73             L    <->   28             L   
74             G    <->   49             G   
75             L    <->   30             F   
76             E    <->   34             E   
79             E    <->   76             G   
80             S    <->   77             A   
82             L    <->   43             L   
83             A    <->   48             A   
84             D    <->   75             D   
85             M    <->   63             M   
87             Q    <->   100            Q   
88             A    <->   99             A   
90             N    <->   94             N   
91             R    <->   91             K   
96             P    <->   61             P   
97             D    <->   41             D   
98             A    <->   103            A   
99             A    <->   113            A   
100            Q    <->   44             N   
101            C    <->   24             L   
102            L    <->   120            L   
103            A    <->   70             K   
104            E    <->   67             E   
105            L    <->   46             L   
106            A    <->   79             S   
108            L    <->   81             L   
109            K    <->   92             K   
111            A    <->   42             A   
112            I    <->   83             V   
113            L    <->   84             L   
114            S    <->   56             S   
115            N    <->   57             D   
116            G    <->   39             G   
117            A    <->   90             A   
119            D    <->   93             E   
120            M    <->   60             M   
121            L    <->   69             L   
122            Q    <->   47             Q   
123            A    <->   97             A   
125            V    <->   21             V   
126            A    <->   74             A   
127            N    <->   23             N   
128            A    <->   101            A   
129            G    <->   29             G   
130            L    <->   72             I   
131            T    <->   31             N   
132            D    <->   32             N   
133            S    <->   78             M   
134            F    <->   51             Y   
135            D    <->   52             G   
137            V    <->   33             V   
138            I    <->   55             I   
139            S    <->   37             E   
140            V    <->   108            V   
141            D    <->   38             D   
144            R    <->   62             N   
147            K    <->   109            K   
148            P    <->   110            P   
150            P    <->   82             P   
153            Y    <->   106            Y   
155            L    <->   66             L   
158            E    <->   27             E   
159            V    <->   40             V   
160            L    <->   68             L   
161            G    <->   50             G   
163            T    <->   112            T   
165            A    <->   80             A   
167            V    <->   54             V   
168            L    <->   9              L   
169            F    <->   85             M   
170            V    <->   86             V   
171            S    <->   87             T   
172            S    <->   88             A   
173            N    <->   59             N   
176            D    <->   12             D   
177            V    <->   11             V   
179            G    <->   65             G   
180            A    <->   98             A   
181            K    <->   45             K   
184            G    <->   102            G   
185            F    <->   53             F   
189            R    <->   58             W   
192            R    <->   73             R   
196            E    <->   118            E   
197            A    <->   114            A   
198            L    <->   127            L   
199            A    <->   121            N   
200            R    <->   122            K   
201            E    <->   125            E   
207            I    <->   96             I   
208            A    <->   2              A   
213            F    <->   124            F   
214            K    <->   4              K   
215            A    <->   126            K   
216            L    <->   6              L   
220            E    <->   3              D   
221            E    <->   5              E   
228            D    <->   104            S   
237            L    <->   116            L   
243            G    <->   128            G   
244            M    <->   129            M   
---------------------------------------------

STEP 7: Filtering alignment...
  - Raw alignment pairs: 128
  - After isolation filter: 52 pairs
  - After overlap resolver: 43 pairs

--- Final Summary ---
  Final number of aligned pairs: 43
  Sequence Identity of final pairs: 65.12%

--- Final Aligned Pairs ---
SeqA PDB Num   AA   <->   SeqB PDB Num   AA  
---------------------------------------------
3              K    <->   7              K   
5              V    <->   8              F   
8              D    <->   13             D   
10             Y    <->   14             F   
12             T    <->   16             T   
18             S    <->   15             S   
43             L    <->   95             I   
54             R    <->   19             R   
57             D    <->   64             D   
61             V    <->   107            V   
64             E    <->   35             E   
69             T    <->   115            T   
71             G    <->   26             K   
76             E    <->   34             E   
79             E    <->   76             G   
88             A    <->   99             A   
90             N    <->   94             N   
91             R    <->   91             K   
96             P    <->   61             P   
100            Q    <->   44             N   
103            A    <->   70             K   
104            E    <->   67             E   
106            A    <->   79             S   
108            L    <->   81             L   
112            I    <->   83             V   
117            A    <->   90             A   
147            K    <->   109            K   
155            L    <->   66             L   
159            V    <->   40             V   
167            V    <->   54             V   
169            F    <->   85             M   
170            V    <->   86             V   
171            S    <->   87             T   
176            D    <->   12             D   
179            G    <->   65             G   
189            R    <->   58             W   
192            R    <->   73             R   
200            R    <->   122            K   
221            E    <->   5              E   
228            D    <->   104            S   
237            L    <->   116            L   
243            G    <->   128            G   
244            M    <->   129            M   
---------------------------------------------

🎉 UniAlign-V6 process finished successfully!
